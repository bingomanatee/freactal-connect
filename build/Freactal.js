(function(a,b){'object'==typeof exports&&'object'==typeof module?module.exports=b():'function'==typeof define&&define.amd?define('Freactal',[],b):'object'==typeof exports?exports.Freactal=b():a.Freactal=b()})('undefined'==typeof self?this:self,function(){return function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,b),e.l=!0,e.exports}var c={};return b.m=a,b.c=c,b.d=function(a,c,d){b.o(a,c)||Object.defineProperty(a,c,{configurable:!1,enumerable:!0,get:d})},b.n=function(a){var c=a&&a.__esModule?function(){return a['default']}:function(){return a};return b.d(c,'a',c),c},b.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},b.p='./',b(b.s=3)}([function(a){a.exports=require('react')},function(a){a.exports=require('@wonderlandlabs/freactal-engine')},function(a,b,c){'use strict';Object.defineProperty(b,'__esModule',{value:!0});var d=c(1),e=c.n(d),f=c(0),g=c.n(f),h=g.a.createContext(null),i=Object.assign||function(a){for(var b,c=1;c<arguments.length;c++)for(var d in b=arguments[c],b)Object.prototype.hasOwnProperty.call(b,d)&&(a[d]=b[d]);return a},j=function(a,b){class c extends f.Component{get engineState(){return this.engine?this.engine.state:{}}get engineActions(){return this.engine?this.engine.actions:{}}get engine(){return this._engine}get updatedProps(){const a=i({},this.props);return delete a.children,b?b(a,this.engine):Object.assign({},a,{actions:this.engineActions,effects:this.engineActions,state:this.engineState})}set engine(a){a===this._engine||(this._engineSubscriber&&this._engineSubscriber.unsubscribe(),a&&(this._engineSubscriber=a.subscribe(this.updateState(),this.engineError(),this.unsubscribe())),this._engine=a)}updateState(){const a=this;return()=>a.forceUpdate()}engineError(a){const b=this;return()=>{console.log('freactal state error:',a,b.engine)}}unsubscribe(){const a=this;return()=>{a._engineSubscriber&&(a._engineSubscriber.unsubscribe(),a._engineSubscriber=null)}}render(){return Object(f.createElement)(h.Consumer,null,(b)=>(this.engine=b,Object(f.createElement)(a,this.updatedProps,this.props.children)))}}return c},k=function(a,b,c){const e=function(b){let e=b;c&&(e=j(b));class g extends f.Component{constructor(b){super(b),this.state={engine:a}}render(){let a=this.state.engine;return Object(f.createElement)(h.Consumer,null,(b)=>(b&&(a=new d.StoreEngineReducer([b,this.state.engine])),Object(f.createElement)(h.Provider,{value:a},Object(f.createElement)(e,this.props))))}}return g};return b?e(c?j(b):b):e},l=function(a,b,c){return function(b){let e=b;c&&(e=j(b));class g extends f.Component{constructor(b){super(b),this.state=Array.isArray(a)?{engine:new d.StoreEngine(...a)}:{engine:new d.StoreEngine(a)}}render(){let a=this.state.engine;return Object(f.createElement)(h.Consumer,null,(b)=>(b&&(a=new d.StoreEngineReducer([b,this.state.engine])),Object(f.createElement)(h.Provider,{value:a},Object(f.createElement)(e,this.props))))}}return g}};c.d(b,'FreactalContext',function(){return h}),c.d(b,'injectState',function(){return j}),c.d(b,'provideState',function(){return l}),c.d(b,'provideEngine',function(){return k}),c.d(b,'update',function(){return d.update}),c.d(b,'StoreEngine',function(){return d.StoreEngine})},function(a,b,c){a.exports=c(2)}])});
//# sourceMappingURL=Freactal.js.map